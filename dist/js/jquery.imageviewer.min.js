!function(t){var a={selector:".image",interfaceTop:!0,interfaceBottom:!0,interfaceNav:!0,keyboardNav:!0,loadAtStart:2};t.fn.imageViewer=function(e){if(0===t(this).length)return t(this);var i={},s=t(this);i.settings=t.extend({},a,e),i.images=s.children(i.settings.selector),i.firstImage=i.images.slice(0,1),i.numImages=i.images.length,i.currentImage=s.children(".active");var n=function(){i.settings.interfaceTop&&r("top"),i.settings.interfaceBottom&&r("bottom"),i.settings.interfaceNav&&r("nav"),v(i.firstImage,!0),l(i.firstImage),i.settings.loadAtStart>2&&(i.settings.loadAtStart>i.numImages&&(i.settings.loadAtStart=i.numImages),v(i.images.slice(2,i.settings.loadAtStart),!1)),t(i.settings.selector).bind("click",function(a){a.preventDefault(),h(t(this))}),t(".nav-item").bind("click",function(a){a.preventDefault(),l(t(this).hasClass("next")?c():o())}),i.settings.keyboardNav&&t(document).keydown(function(t){37==t.keyCode?(u(o()),l(o())):39==t.keyCode&&(u(c()),l(c()))}),t(window).resize(function(){var t=s.width(),a=s.height();g(s.find(".active"),t,a)})},r=function(t){"top"==t&&s.before('<section id="top" class="interface"><ul class="details"><li class="image-position"><span class="value"></span><li class="image-title"><span class="value"></span><li class="image-src"><span class="label">Filename:</span> <span class="value"></span></ul></section>'),"bottom"==t&&s.before('<section id="bottom" class="interface"><ul class="details"><li class="image-width"><span class="label">Width:</span> <span class="value"></span><li class="image-height"><span class="label">Height:</span> <span class="value"></span><li class="image-scale"><span class="label">Scale:</span> <span class="value"></span><li class="image-download"><a href="#" target="_blank">Download</a></ul></section>'),"nav"==t&&s.before('<section id="nav" class="interface"><a href="#" class="nav-item prev">Previous</a><a href="#" class="nav-item next">Next</a></section>')},l=function(a){i.images.removeClass("active"),a.addClass("active"),t(window).trigger("resize"),v(c()),v(o())},c=function(){var a=t(".active").index();return a==i.numImages-1?t(i.settings.selector).first():t(".active").next()},o=function(){var a=t(".active").index();return 0===a?t(i.settings.selector).last():t(".active").prev()},g=function(a,e,s){var n={title:a.attr("data-title"),src:a.attr("data-src").replace(/^.*[\\\/]/,""),width:a.attr("data-orig-width"),height:a.attr("data-orig-height"),scale:d(a,e,s)};t(".image-position .value").text(a.index()+1+"/"+i.numImages),t(".image-title .value").text(n.title),t(".image-src .value").text(n.src),t(".image-width .value").text(n.width),t(".image-height .value").text(n.height),t(".image-scale .value").text(n.scale),t(".image-download a").attr("href",a.attr("data-src"))},d=function(t,a,e){var i,s=a,n=e,r=t.attr("data-orig-width"),l=t.attr("data-orig-height"),c=s/n,o=r/l;return i=1>o?c>o?n/l:s/r:o>c?s/r:n/l,Math.round(100*i)+"%"},h=function(t){t.hasClass("original")?u(t):m(t)},u=function(a){a.removeClass("original"),a.css("width","100%"),a.css("height","100%"),t(".interface").removeClass("hidden")},m=function(a){var e=a.attr("data-orig-width"),i=a.attr("data-orig-height");a.addClass("original"),a.css("width",e+"px"),a.css("height",i+"px"),t(".interface").addClass("hidden")},v=function(a,e){a.each(function(){var a=t(this),i=new Image;i.src=a.attr("data-src"),i.onload=function(){var s=i.width,n=i.height;a.attr("data-orig-width",s),a.attr("data-orig-height",n),a.css("background-image","url("+i.src+")"),a.addClass("loaded"),e&&t(window).trigger("resize")}})};return s.each(function(){n()})}}(jQuery);