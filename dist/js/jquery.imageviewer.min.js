!function(a){var t={selector:".image",interfaceTop:!0,interfaceNav:!0,keyboardNav:!0,loadAtStart:2};a.fn.imageViewer=function(e){if(0===a(this).length)return a(this);var i={},s=a(this);i.settings=a.extend({},t,e),i.images=s.children(i.settings.selector),i.firstImage=i.images.slice(0,1),i.numImages=i.images.length,i.currentImage=s.children(".active");var n=function(){console.log(i.images),i.settings.interfaceTop&&r("top"),i.settings.interfaceNav&&r("nav"),u(i.firstImage,!0),c(i.firstImage),i.settings.loadAtStart>2&&(i.settings.loadAtStart>i.numImages&&(i.settings.loadAtStart=i.numImages),u(i.images.slice(2,i.settings.loadAtStart),!1)),a(i.settings.selector).bind("click",function(t){t.preventDefault(),h(a(this))}),a(".nav-item").bind("click",function(t){t.preventDefault(),c(a(this).hasClass("next")?l():g())}),i.settings.keyboardNav&&a(document).keydown(function(a){37==a.keyCode?c(g()):39==a.keyCode&&c(l())}),a(window).resize(function(){var a=s.width(),t=s.height();o(s.find(".active"),a,t)})},r=function(a){"top"==a&&s.before('<section id="top" class="interface"><ul class="details"><li class="image-title"><span class="value"></span><li class="image-src"><span class="label">Filename:</span> <span class="value"></span><li class="image-width"><span class="label">Width:</span> <span class="value"></span><li class="image-height"><span class="label">Height:</span> <span class="value"></span><li class="image-scale"><span class="label">Scale:</span> <span class="value"></span></ul></section>'),"nav"==a&&s.before('<section id="nav" class="interface"><a href="#" class="nav-item prev">Previous</a><a href="#" class="nav-item next">Next</a></section>')},c=function(t){i.images.removeClass("active"),t.addClass("active"),a(window).trigger("resize"),u(l()),u(g())},l=function(){var t=a(".active").index();return t==i.numImages-1?a(i.settings.selector).first():a(".active").next()},g=function(){var t=a(".active").index();return 0===t?a(i.settings.selector).last():a(".active").prev()},o=function(t,e,i){var s={title:t.attr("data-title"),src:t.attr("data-src").replace(/^.*[\\\/]/,""),width:t.attr("data-orig-width"),height:t.attr("data-orig-height"),scale:d(t,e,i)};a(".image-title .value").text(s.title),a(".image-src .value").text(s.src),a(".image-width .value").text(s.width),a(".image-height .value").text(s.height),a(".image-scale .value").text(s.scale)},d=function(a,t,e){var i,s=t,n=e,r=a.attr("data-orig-width"),c=a.attr("data-orig-height"),l=s/n,g=r/c;return i=1>g?l>g?n/c:s/r:g>l?s/r:n/c,Math.round(100*i)+"%"},h=function(t){var e=t.attr("data-orig-width"),i=t.attr("data-orig-height");t.hasClass("original")?(t.removeClass("original"),t.css("width","100%"),t.css("height","100%"),a(".interface").removeClass("hidden")):(t.addClass("original"),t.css("width",e+"px"),t.css("height",i+"px"),a(".interface").addClass("hidden"))},u=function(t,e){t.each(function(){var t=a(this),i=new Image;i.src=t.attr("data-src"),i.onload=function(){var s=i.width,n=i.height;t.attr("data-orig-width",s),t.attr("data-orig-height",n),t.css("background-image","url("+i.src+")"),t.addClass("loaded"),e&&a(window).trigger("resize")}})};return s.each(function(){n()})}}(jQuery);